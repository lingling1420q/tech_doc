### 结论
数据库设置的连接池不是越大越好。
连接池2000减少到100，可能性能反而能提高十倍。

### 原因
cpu在执行多线程时，上下文切换是有性能损耗的。

一核CPU，顺序执行A和B永远比通过时间分片“同时”执行A和B要快，这是一条计算机科学的基本法则。

一旦线程的数量超过了CPU核心的数量，再增加线程数系统就只会更慢，而不是更快。

一个8核的服务器上，设定连接/线程数为8能够提供最优的性能，再增加连接数就会因上下文切换的损耗导致性能下降。

### 连接池设置大小

连接数 = ((核心数 * 2) + 有效磁盘数)

你的4核i7数据库服务器的连接池大小应该为((4 * 2) + 1) = 9

公理：你需要一个小连接池，和一个充满了等待连接的线程的队列。

10000个并发，需要一个10来个连接的小连接池，然后让剩下的业务线程都在队列里等待。这样性能最佳。

### 参考文章
https://www.jianshu.com/p/a8f653fc0c54
https://github.com/brettwooldridge/HikariCP/wiki/About-Pool-Sizing